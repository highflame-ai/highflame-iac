adminUser: highflame_admin
adminPassword: ${grafana_secret}

dashboardProviders:
  dashboardproviders.yaml:
    apiVersion: 1
    providers:
    - name: 'default'
      orgId: 1
      folder: ''
      type: file
      disableDeletion: false
      editable: false
      options:
        path: /var/lib/grafana/dashboards/default

dashboardsConfigMaps:
  default: "${project_name}-grafana-dashboards"

persistence:
  enabled: true
  storageClassName: ${storage_classname}
  size: ${grafana_disk_size}

datasources:
  datasources.yaml:
    apiVersion: 1
    datasources:
    - name: prometheus
      type: prometheus
      url: ${prometheus_url}
      access: proxy
      isDefault: true

grafana.ini:
  server:
    # domain: grafana_domain
    root_url: "%(protocol)s://%(domain)s/${grafana_subpath}"
    serve_from_sub_path: true

resources:
  requests:
    memory: 64Mi
    cpu: 50m
  limits:
    memory: 256Mi
    cpu: 200m

service:
  enabled: true
  annotations:
    alb.ingress.kubernetes.io/healthcheck-path: /api/health
  type: NodePort
  protocol: TCP

ingress:
  enabled: true
  ingressClassName: "alb"
  annotations:
    alb.ingress.kubernetes.io/scheme: internet-facing
    alb.ingress.kubernetes.io/healthcheck-protocol: HTTP 
    alb.ingress.kubernetes.io/healthcheck-port: traffic-port
    alb.ingress.kubernetes.io/target-type: instance
    alb.ingress.kubernetes.io/ssl-redirect: '443'
    alb.ingress.kubernetes.io/listen-ports: '[{"HTTP": 80}, {"HTTPS": 443}]'
    alb.ingress.kubernetes.io/healthcheck-interval-seconds: '15'
    alb.ingress.kubernetes.io/healthcheck-timeout-seconds: '5'
    alb.ingress.kubernetes.io/healthy-threshold-count: '2'
    alb.ingress.kubernetes.io/unhealthy-threshold-count: '2'
    alb.ingress.kubernetes.io/success-codes: '200'
    alb.ingress.kubernetes.io/group.order: '3'

    alb.ingress.kubernetes.io/load-balancer-name: ${k8s_cluster_name}-alb-ingress
    alb.ingress.kubernetes.io/group.name: ${k8s_cluster_name}-group
    alb.ingress.kubernetes.io/subnets: ${public_subnet_ids}
    alb.ingress.kubernetes.io/certificate-arn: ${acm_certificate_arn}
    alb.ingress.kubernetes.io/security-groups: ${alb_security_group_ids}
  path: /${grafana_subpath}
  pathType: Prefix
  hosts:
    - ${grafana_domain}